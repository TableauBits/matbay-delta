<h1> Welcome to MATBay Δ </h1>

@if(deltaAuth.isAuthenticated() | async) {
Hello {{currentUser?.displayName}} ({{currentUser?.username}}), you have been authenticated by Auth0 and the Δ
server. <br>
<img [src]="currentUser?.imageURL" width="250" height="250" alt="photo de profil de {{currentUser?.imageURL}}">
"{{currentUser?.description}}"
<app-current-user-form></app-current-user-form>
<hr>
<app-constitution-form></app-constitution-form>
<hr>
<h2> Constitutions </h2>
@for (constitution of constitutions.getAll(); track $index) {
<div>
  <h3>{{$index}} - {{constitution.name}} (id : {{constitution.id}}) </h3>
  <hr>
  <p> Description : {{constitution.description}} </p>
  <p> Owner: {{(users.getUser(constitution.owner) | async)?.displayName}} </p>
  <h3> Participants </h3>
  @for (user of constitution.userConstitution; track $index) {
  <p>
    Participant {{$index}} :
    <img [src]="(users.getUser(user.user) | async)?.imageURL" width="25" height="25"
      alt="photo de profil de {{(users.getUser(user.user) | async)?.imageURL}}">
    {{(users.getUser(user.user) | async)?.displayName}}
  </p>
  }
  <h3> Songs </h3>
  @for (song of constitution.songConstitution; track $index) {
  <p>
    Song {{$index}} : (id: {{song.song}}) added by     <img [src]="(users.getUser(song.user) | async)?.imageURL" width="25" height="25"
      alt="photo de profil de {{(users.getUser(song.user) | async)?.imageURL}}"> {{(users.getUser(song.user) | async)?.displayName}}
  </p>
  }
  @if(constitution.songConstitution.length === 0) {
    No song.
  }
  <app-add-song-form [constitution]="constitution.id"></app-add-song-form>
  <div>
    <button (click)="constitutions.join(constitution.id)"> Join constitution </button>
    <button (click)="constitutions.leave(constitution.id)"> Leave constitution </button>
  </div>
</div>
}
<button (click)="deltaAuth.logout()"> Log out </button>
} @else {
Please log in with your TableauBits account to access the app. <br>
<button (click)="deltaAuth.login()"> Log in </button>
}